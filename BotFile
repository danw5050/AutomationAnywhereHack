{"triggers":[{"uid":"cf95360e-344b-47da-9360-e4f58c879ab9","triggerName":"EmailTrigger","packageName":"Emailtrigger","disabled":false,"attributes":[{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"serverHost","value":{"type":"STRING","string":"imap.gmail.com"}},{"name":"protocol","value":{"type":"STRING","string":"IMAP"}},{"name":"useSecure","value":{"type":"BOOLEAN","boolean":true}},{"name":"port","value":{"type":"NUMBER","number":"993"}},{"name":"pollIntervalForEmail","value":{"type":"NUMBER","number":"30"}},{"name":"unitForEmail","value":{"type":"STRING","string":"SECONDS"}},{"name":"username","value":{"type":"STRING","string":"myflowerbusiness@gmail.com"}},{"name":"securedPassword","value":{"type":"STRING","string":"fakeemail?"}},{"name":"emailType","value":{"type":"STRING","string":"INCOMINGS"}}]}],"nodes":[{"uid":"84eb532f-6de9-4889-bf2a-1c93a53d58b2","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/danw5/Documents/AnywhereHack/Data/customers.xlsx"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"28c3ec0d-7712-4a16-b9c0-f3a4e7cb10fc","commandName":"emailConnect","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession1"}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"serverHost","value":{"type":"STRING","string":"imap.gmail.com"}},{"name":"port","value":{"type":"NUMBER","number":"993"}},{"name":"username","value":{"type":"STRING","string":"myflowerbusiness@gmail.com"}},{"name":"securedPassword","value":{"type":"STRING","string":"fakeemail?"}},{"name":"useSecure","value":{"type":"BOOLEAN","boolean":true}},{"name":"protocol","value":{"type":"STRING","string":"IMAP"}}]},{"uid":"406f882c-b0d4-451a-96df-635e19254967","commandName":"python.commands.openScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"FILE"}},{"name":"file","value":{"type":"FILE","string":"file:///C:/Users/danw5/Documents/AnywhereHack/Python/pictureExtract.py"}},{"name":"version","value":{"type":"STRING","string":"3"}}]},{"uid":"644d3417-363e-439c-af7b-e12af484c8a1","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"57175592-d2f3-4690-9ab7-6ab478b6c113","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"friendlyName"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"emailValue"}}],"returnTo":{"type":"VARIABLE","variableName":"emailName"}},{"uid":"1867f3d2-855e-42a1-9ea4-3811e66ca5e2","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"C:\\Users\\danw5\\Documents\\AnywhereHack\\Emails\\$emailName$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"80e49657-9964-4903-ac57-d1827d24aa6f","commandName":"saveAttachment","packageName":"Email","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"C:\\Users\\danw5\\Documents\\AnywhereHack\\Emails\\$emailName$"}},{"name":"checkOverrwrite","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"50617cdc-04e6-48b4-9299-0dded229b2b8","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"gps"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"emailName"}}],"returnTo":{"type":"VARIABLE","variableName":"gpsVal"}},{"uid":"86c790f2-db69-4d6f-a82d-de6c1248a3ce","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"getOutdoorImage"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"emailName"}}],"returnTo":{"type":"VARIABLE","variableName":"emailFile"}},{"uid":"1772dc4f-2417-4ebc-80d9-f65c149af3e8","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"getOCRImage"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"emailName"}}],"returnTo":{"type":"VARIABLE","variableName":"ocrFile"}},{"uid":"00211540-3ef9-41df-a931-be4e4247b006","commandName":"captureImagebyPath","packageName":"OCR","disabled":false,"attributes":[{"name":"imagePath","value":{"type":"FILE","expression":"file://$ocrFile$"}},{"name":"checkFilterText","value":{"type":"BOOLEAN","boolean":true}},{"name":"beforeSubStr","value":{"type":"STRING","string":""}},{"name":"afterSubStr","value":{"type":"STRING","string":""}},{"name":"checkTrimText","value":{"type":"BOOLEAN","boolean":true}},{"name":"loadProfile","value":{"type":"BOOLEAN","boolean":false}},{"name":"ocrLocale","value":{"type":"STRING","string":"Based on Locale"}}],"returnTo":{"type":"VARIABLE","variableName":"ocrVal"}},{"uid":"f0b78129-8992-43ce-95c1-f9219850be3d","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"findOrderId"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"ocrVal"}}],"returnTo":{"type":"VARIABLE","variableName":"orderId"}},{"uid":"9038508a-71ad-45a2-9072-b611c5cac7aa","commandName":"getNumberOfRows","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"sheetOption","value":{"type":"STRING","string":"BYINDEX"}},{"name":"sheetIndex","value":{"type":"NUMBER","number":"1"}},{"name":"fetchRowsType","value":{"type":"STRING","string":"NONEMPTY"}}],"returnTo":{"type":"VARIABLE","variableName":"totalNumRows"}},{"uid":"326417b4-8b9a-4fa0-ac3a-09f1a5630e9b","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"cde8075c-2f4d-4874-b36d-3ef272fbaaf6","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6a2c62cd-2285-48a7-8d41-15d844bad728","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Unknown Order"}},{"name":"content","value":{"type":"STRING","expression":"Order $orderId$ not found in customer orders"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"263a3b40-87ae-48a4-94c4-e476fd37452a","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$excelIndex$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","expression":"$totalNumRows$ + 1"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]},{"uid":"966cf4c8-564b-48df-aacd-5e7ac1a37106","commandName":"readExcelRow","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cellAddress","value":{"type":"STRING","expression":"A$excelIndex.Number:toString$"}},{"name":"readFullRow","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"rowOrderIdMatch"}},{"uid":"b4eaa8b4-f6aa-4e93-96db-4da44181abef","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"4df15ebd-ebac-43ea-adc7-153dca121004","commandName":"python.commands.executeFunction","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"verifyAddress"}},{"name":"argument","value":{"type":"VARIABLE","variableName":"rowOrderIdMatch"}}],"returnTo":{"type":"VARIABLE","variableName":"addressVerified"}},{"uid":"4339a08c-6898-4505-ab82-29d212a7ec66","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"86ddbc45-3f70-443f-a3e4-add70bdbaeed","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$rowOrderIdMatch[3]$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Your MyFlower order has been delivered!"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$emailFile$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"\nHello $rowOrderIdMatch[2]$, <br/>\n<b>Your order $rowOrderIdMatch[0]$ has been delivered!</b><br/>\nThank you for shopping with us. We have included an image as to where you can find the delivery at your house <br/>\n<br/>\n<i>Your Flower Provider,</i> <br/>\nMyFlowerBusiness | myflowerbusiness@gmail.com\n<br/><br/><br/>\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"myflowerbusiness@gmail.com"}},{"name":"emailServerHost","value":{"type":"STRING","string":"imap.gmail.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"993"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":true}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":true}},{"name":"username","value":{"type":"STRING","string":"myflowerbusiness@gmail.com"}},{"name":"securedPassword","value":{"type":"STRING","string":"fakeemail?"}}]},{"uid":"58b17bb3-5dd8-4d71-a267-d6ca4fce620f","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"F$excelIndex.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$emailValue{emailReceivedDate}$"}}]},{"uid":"0898da2f-5e0a-47b9-817e-11d76a9a5d9d","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"E$excelIndex.Number:toString$"}},{"name":"value","value":{"type":"STRING","string":"Delivered"}}]}],"branches":[{"uid":"6b200a38-949c-4b13-8061-3636659159ad","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"579029de-1dfd-46a7-8c51-04bc63d674de","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$emailValue{emailFrom}$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Incorrect Order Delivery"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$emailFile$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"\nOrder $rowOrderIdMatch[0]$ has been sent to an incorrect location. <br/><br/><br/><br/>\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"myflowerbusiness@gmail.com"}},{"name":"emailServerHost","value":{"type":"STRING","string":"imap.gmail.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"993"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":true}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":true}},{"name":"username","value":{"type":"STRING","string":"myflowerbusiness@gmail.com"}},{"name":"securedPassword","value":{"type":"STRING","string":"fakeemail?"}}]},{"uid":"79bd1e38-1f53-4947-9bd0-3ee8285a6c58","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"E$excelIndex.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"Incorrect GPS location ($gpsVal$) "}}]},{"uid":"54818287-b221-4464-a2e7-9c4cb9e79c7a","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Order destination incorrect"}},{"name":"content","value":{"type":"STRING","expression":"Order $rowOrderIdMatch[0]$ sent to unknown destination $gpsVal$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$addressVerified$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"21c0ffe6-c09a-458c-9f4c-8b41eaba1f7c","commandName":"loop.commands.break","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$rowOrderIdMatch[0]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$orderId$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"excelIndex"},"attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$totalNumRows$ + 1"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]},{"uid":"d6cb265d-7b16-4551-b48b-71d49cbccfef","commandName":"changeStatus","packageName":"Email","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession1"}},{"name":"changeStatusTo","value":{"type":"STRING","string":"Read"}}]},{"uid":"ab73bf3a-d3bc-464f-97b7-f07cc3d9e3b9","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"You have mail! $gpsVal$ and $ocrVal$ and $ocrFile$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"emailValue"},"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"EmailSession1"}},{"name":"readStatus","value":{"type":"STRING","string":"UNREAD"}},{"name":"folder","value":{"type":"STRING","string":"Inbox"}},{"name":"subject","value":{"type":"STRING","string":""}},{"name":"from","value":{"type":"STRING","string":""}},{"name":"messageFormat","value":{"type":"STRING","string":"PLAINTEXT"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.email","packageName":"Email"}}]},{"uid":"c054efa4-d4e9-4d1a-a488-0785e45b95ca","commandName":"python.commands.closeScript","packageName":"Python","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"971230c0-65d3-4cfa-a87f-5fd7cc76c3ef","commandName":"closeEmail","packageName":"Email","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"EmailSession1"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"gpsVal","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":"none"}},{"name":"emailValue","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"emailName","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ocrVal","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"ocrFile","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"emailFile","description":"","type":"ANY","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"orderId","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"rowOrderIdMatch","description":"","type":"LIST","readOnly":false,"input":false,"output":true,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"rowVal","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"addressVerified","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"excelIndex","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"totalNumRows","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":["406f882c-b0d4-451a-96df-635e19254967"],"packages":[{"name":"Email","version":"2.0.0-20200418-005352"},{"name":"Emailtrigger","version":"1.1.0-20200418-005652"},{"name":"Excel_MS","version":"2.0.0-20200422-000103"},{"name":"Folder","version":"2.0.0-20200418-005400"},{"name":"If","version":"2.0.0-20200418-005406"},{"name":"Loop","version":"2.0.0-20200418-005424"},{"name":"MessageBox","version":"2.0.0-20200418-005424"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"OCR","version":"2.1.0-20200418-005434"},{"name":"Python","version":"2.0.0-20200418-005537"},{"name":"String","version":"3.0.0-20200418-005635"}],"workItemTemplateName":null}